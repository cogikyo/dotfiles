#!/bin/bash

# Script to switch default branch from main to master
# Usage: ./gh-master

set -e  # Exit on any error

echo "Switching default branch from main to master..."

# Check if we're on main branch
current_branch=$(git branch --show-current)
if [ "$current_branch" != "main" ]; then
    echo "x Error: Not on main branch. Current branch: $current_branch"
    exit 1
fi

# Check if gh CLI is available
if ! command -v gh &> /dev/null; then
    echo "Error: GitHub CLI (gh) is not installed"
    exit 1
fi

echo "Step 1: Renaming local branch from main to master"
git branch -m main master

echo "Step 2: Pushing master branch to remote"
git push -u origin master

echo "Step 3: Changing default branch on GitHub"
gh repo edit --default-branch master

echo "Step 4: Deleting old main branch if you want by running:"
echo "git push origin --delete main"